// This is your Events Prisma schema file for aztec_attester_events table
// This database is separate from the main database and persists across main DB resets

generator client {
  provider      = "prisma-client-js"
  output        = "../../node_modules/@prisma/events-client"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("EVENTS_DATABASE_URL")
}

model AztecAttesterEvent {
  id              Int      @id @default(autoincrement())
  chainId         Int      @map("chain_id")
  blockNumber     String   @map("block_number") @db.VarChar(256)
  transactionHash String   @map("transaction_hash") @db.VarChar(256)
  logIndex        Int      @map("log_index")
  providerId      String   @map("provider_id") @db.VarChar(256)
  providerAddress String?  @map("provider_address") @db.VarChar(256)
  attesters       String[] @map("attesters")
  timestamp       DateTime @map("timestamp") @db.Timestamptz(6)
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@unique([chainId, transactionHash, logIndex], map: "aztec_attester_event_unique")
  @@index([chainId, blockNumber], map: "aztec_attester_event_chain_block_idx")
  @@index([chainId, providerAddress], map: "aztec_attester_event_chain_provider_idx")
  @@map("aztec_attester_events")
}

model AztecStakedEvent {
  id                           Int      @id @default(autoincrement())
  chainId                      Int      @map("chain_id")
  blockNumber                  String   @map("block_number") @db.VarChar(256)
  transactionHash              String   @map("transaction_hash") @db.VarChar(256)
  logIndex                     Int      @map("log_index")
  providerId                   String   @map("provider_id") @db.VarChar(256)
  providerAddress              String?  @map("provider_address") @db.VarChar(256)
  rollupAddress                String   @map("rollup_address") @db.VarChar(256)
  attesterAddress              String   @map("attester_address") @db.VarChar(256)
  coinbaseSplitContractAddress String?  @map("coinbase_split_contract_address") @db.VarChar(256)
  stakerImplementation         String?  @map("staker_implementation") @db.VarChar(256)
  timestamp                    DateTime @map("timestamp") @db.Timestamptz(6)
  createdAt                    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@unique([chainId, transactionHash, logIndex], map: "aztec_staked_event_unique")
  @@index([chainId, blockNumber], map: "aztec_staked_event_chain_block_idx")
  @@index([chainId, providerAddress], map: "aztec_staked_event_chain_provider_idx")
  @@index([chainId, attesterAddress], map: "aztec_staked_event_chain_attester_idx")
  @@map("aztec_staked_events")
}

model AztecSlashedEvent {
  id              Int      @id @default(autoincrement())
  chainId         Int      @map("chain_id")
  blockNumber     String   @map("block_number") @db.VarChar(256)
  transactionHash String   @map("transaction_hash") @db.VarChar(256)
  logIndex        Int      @map("log_index")
  attester        String   @map("attester") @db.VarChar(256)
  amount          String   @map("amount") @db.VarChar(256)
  timestamp       DateTime @map("timestamp") @db.Timestamptz(6)
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@unique([chainId, transactionHash, logIndex], map: "aztec_slashed_event_unique")
  @@index([chainId, blockNumber], map: "aztec_slashed_event_chain_block_idx")
  @@index([chainId, attester], map: "aztec_slashed_event_chain_attester_idx")
  @@map("aztec_slashed_events")
}

model AztecVoteCastEvent {
  id              Int      @id @default(autoincrement())
  chainId         Int      @map("chain_id")
  blockNumber     String   @map("block_number") @db.VarChar(256)
  transactionHash String   @map("transaction_hash") @db.VarChar(256)
  logIndex        Int      @map("log_index")
  proposalId      String   @map("proposal_id") @db.VarChar(256)
  voter           String   @map("voter") @db.VarChar(256)
  support         Boolean  @map("support")
  amount          String   @map("amount") @db.VarChar(256)
  timestamp       DateTime @map("timestamp") @db.Timestamptz(6)
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@unique([chainId, transactionHash, logIndex], map: "aztec_vote_cast_event_unique")
  @@index([chainId, blockNumber], map: "aztec_vote_cast_event_chain_block_idx")
  @@index([chainId, proposalId], map: "aztec_vote_cast_event_chain_proposal_idx")
  @@index([chainId, voter], map: "aztec_vote_cast_event_chain_voter_idx")
  @@map("aztec_vote_cast_events")
}
